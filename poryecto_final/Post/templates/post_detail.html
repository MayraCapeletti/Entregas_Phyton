{% extends 'padre.html' %}
{% load crispy_forms_tags %}
{% block bloque_titulo %}Detalle de Post{% endblock %}
{% block bloque_header %}
    <header class="post" style="background-image: url('{{ post.image.url }}')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <div class="post-heading">
                        <h1>{{ post.title }}</h1>
                        <h2 class="subheading">{{ post.subtitle }}</h2>
                        <span class="meta">
                            Posteado por {{ post.author }} el {{ post.created_at }}.
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
{% endblock bloque_header %}

{% block contenidoQueCambia %}
<main class="flex-shrink-0">
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-8">
                <p class="lead">{{ post.body }}</p>
                <a href="{% url 'ver_posts' %}" class= "back">Back</a>
            </div>
                <hr>
            <div class="comments">
                <h3>Comentarios</h3>               
                    {% for comment in post.comments.all %}
                        <div class="comment mb-3">
                            <h5>{{ comment.name }} <small class="text-muted">{{ comment.created_at }}</small></h5>
                            <p>{{ comment.content }}</p>
                        </div>
                    {% empty %}
                        <p>No hay comentarios aún.</p>
                    {% endfor %}
            </div>
                <hr>
            <div class="comentario">
                {% if user.is_authenticated %}
                <h3>Deja un comentario</h3>
                <form method="post" class="comment-form">
                    {% csrf_token %}
                    {{ form|crispy }}
                    <button type="submit" class="btn btn-primary mt-2">Enviar comentario</button>
                </form>
                {% else %}
                <p>Debes <a href="{% url 'Login' %}">iniciar sesión</a> para dejar un comentario.</p>
                {% endif %}
            </div>
        </div>
    </div>
</main>
{% endblock %}
